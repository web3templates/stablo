{
  "version": 3,
  "sources": ["../../../../src/components/menu/menuGroup.tsx"],
  "sourcesContent": ["import {ChevronRightIcon} from '@sanity/icons'\nimport React, {useCallback, useEffect, useRef, useState} from 'react'\nimport styled from 'styled-components'\nimport {Box, Popover, PopoverProps, Text} from '../../primitives'\nimport {Selectable} from '../../primitives/_selectable'\nimport {SelectableTone} from '../../types/selectable'\nimport {Menu} from './menu'\nimport {useMenu} from './useMenu'\n\n/**\n * @public\n */\nexport interface MenuGroupProps {\n  as?: React.ElementType | keyof JSX.IntrinsicElements\n  fontSize?: number | number[]\n  padding?: number | number[]\n  popover?: Omit<PopoverProps, 'content' | 'open'>\n  radius?: number | number[]\n  text: React.ReactNode\n  tone?: SelectableTone\n}\n\nconst MOUSE_LEAVE_TIMEOUT = 1000\n\nconst TextContainer = styled.span`\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  & > div:first-child {\n    flex: 1;\n    min-width: 0;\n  }\n`\n\n/**\n * @public\n */\nexport function MenuGroup(\n  props: MenuGroupProps &\n    Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref' | 'tabIndex'>\n): React.ReactElement {\n  const {\n    as = 'button',\n    children,\n    fontSize,\n    onClick,\n    padding = 3,\n    popover = {},\n    radius = 2,\n    text,\n    tone = 'default',\n    ...restProps\n  } = props\n  const [open, setOpen] = useState(false)\n  const {\n    activeElement,\n    mount,\n    onClickOutside,\n    onEscape,\n    onItemClick,\n    onMouseEnter,\n    onMouseLeave,\n    registerElement,\n  } = useMenu()\n  const [rootElement, setRootElement] = useState<HTMLButtonElement | null>(null)\n  const mouseLeaveTimeoutRef = useRef<NodeJS.Timeout | null>(null)\n  const shouldFocusRef = useRef<'first' | 'last' | null>(null)\n  const active = Boolean(activeElement) && activeElement === rootElement\n  // const selected = active || open\n\n  // Register the element\n  useEffect(() => mount(rootElement), [mount, rootElement])\n\n  const handleMouseEnter = useCallback(\n    (event: React.MouseEvent<HTMLElement>) => {\n      if (mouseLeaveTimeoutRef.current) {\n        clearTimeout(mouseLeaveTimeoutRef.current)\n        mouseLeaveTimeoutRef.current = null\n      }\n\n      onMouseEnter(event)\n      setOpen(true)\n    },\n    [onMouseEnter]\n  )\n\n  const handleMouseLeave = useCallback(\n    (event: React.MouseEvent<HTMLElement>) => {\n      onMouseLeave(event)\n\n      mouseLeaveTimeoutRef.current = setTimeout(() => {\n        setOpen(false)\n      }, MOUSE_LEAVE_TIMEOUT)\n    },\n    [onMouseLeave]\n  )\n\n  const handleMenuKeyDown = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      if (event.key === 'ArrowLeft') {\n        event.stopPropagation()\n\n        setOpen(false)\n\n        requestAnimationFrame(() => {\n          rootElement?.focus()\n        })\n      }\n    },\n    [rootElement]\n  )\n\n  const handleMenuMouseEnter = useCallback(() => {\n    if (mouseLeaveTimeoutRef.current) {\n      clearTimeout(mouseLeaveTimeoutRef.current)\n      mouseLeaveTimeoutRef.current = null\n    }\n  }, [])\n\n  const handleMenuMouseLeave = useCallback(() => {\n    mouseLeaveTimeoutRef.current = setTimeout(() => {\n      setOpen(false)\n    }, MOUSE_LEAVE_TIMEOUT)\n  }, [])\n\n  const handleClick = useCallback(\n    (event: React.MouseEvent<HTMLDivElement>) => {\n      if (onClick) onClick(event)\n\n      shouldFocusRef.current = 'first'\n\n      setOpen(true)\n\n      requestAnimationFrame(() => {\n        shouldFocusRef.current = null\n      })\n    },\n    [onClick]\n  )\n\n  const handleItemClick = useCallback(() => {\n    setOpen(false)\n    if (onItemClick) onItemClick()\n  }, [onItemClick])\n\n  useEffect(() => {\n    return () => {\n      if (mouseLeaveTimeoutRef.current !== null) {\n        clearTimeout(mouseLeaveTimeoutRef.current)\n        mouseLeaveTimeoutRef.current = null\n      }\n    }\n  }, [])\n\n  const content = (\n    <Menu\n      onClickOutside={onClickOutside}\n      onEscape={onEscape}\n      onItemClick={handleItemClick}\n      onKeyDown={handleMenuKeyDown}\n      onMouseEnter={handleMenuMouseEnter}\n      onMouseLeave={handleMenuMouseLeave}\n      registerElement={registerElement}\n      shouldFocus={shouldFocusRef.current}\n    >\n      {children}\n    </Menu>\n  )\n\n  const handleKeyDown = useCallback((event: React.KeyboardEvent<HTMLDivElement>) => {\n    const target = event.currentTarget\n\n    if (document.activeElement !== target) {\n      return\n    }\n\n    if (event.key === 'ArrowRight') {\n      shouldFocusRef.current = 'first'\n\n      setOpen(true)\n\n      requestAnimationFrame(() => {\n        shouldFocusRef.current = null\n      })\n\n      return\n    }\n  }, [])\n\n  return (\n    <Popover {...popover} content={content} data-ui=\"MenuGroup__popover\" open={open}>\n      <Selectable\n        data-as={as}\n        data-ui=\"MenuGroup\"\n        forwardedAs={as}\n        {...restProps}\n        aria-pressed={as === 'button' ? !active && open : undefined}\n        data-pressed={as !== 'button' ? !active && open : undefined}\n        data-selected={active ? '' : undefined}\n        $radius={radius}\n        $tone={tone}\n        onClick={handleClick}\n        onKeyDown={handleKeyDown}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n        ref={setRootElement}\n        tabIndex={-1}\n        type={as === 'button' ? 'button' : undefined}\n      >\n        <Box padding={padding}>\n          <TextContainer>\n            <Text size={fontSize}>{text}</Text>\n            <Text size={fontSize}>\n              <ChevronRightIcon />\n            </Text>\n          </TextContainer>\n        </Box>\n      </Selectable>\n    </Popover>\n  )\n}\n"],
  "mappings": "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",
  "names": []
}
